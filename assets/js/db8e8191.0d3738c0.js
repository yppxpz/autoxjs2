"use strict";(self.webpackChunkautox_doc=self.webpackChunkautox_doc||[]).push([[6691],{2223:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>i,contentTitle:()=>c,default:()=>u,frontMatter:()=>s,metadata:()=>l,toc:()=>o});var a=t(4848),r=t(8453);const s={},c="event-stream",l={id:"rhino/npm/event-stream",title:"event-stream",description:"v6.4.0\u65b0\u589e",source:"@site/docs/rhino/npm/event-stream.md",sourceDirName:"rhino/npm",slug:"/rhino/npm/event-stream",permalink:"/docs/rhino/npm/event-stream",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/rhino/npm/event-stream.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"cheerio",permalink:"/docs/rhino/npm/cheerio"},next:{title:"events",permalink:"/docs/rhino/npm/events"}},i={},o=[];function d(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.h1,{id:"event-stream",children:"event-stream"}),"\n",(0,a.jsx)(n.p,{children:"v6.4.0\u65b0\u589e"}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"\u7a33\u5b9a\u6027: \u7a33\u5b9a"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"\u6765\u81eanpm\u6a21\u5757event-stream\uff0c\u5982\u9700\u4f7f\u7528\uff0c\u8bf7\u7528"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"const es = require('event-stream')\n"})}),"\n",(0,a.jsxs)(n.p,{children:["\u8be5\u6a21\u5757\u7528\u4e8e\u4fbf\u6377\u7684\u521b\u5efa\u6d41\uff0c\u5b8c\u6574\u8bf4\u660e\u89c1",(0,a.jsx)(n.a,{href:"https://github.com/dominictarr/event-stream",children:"\u9879\u76ee\u4e3b\u9875"}),"\n\u53ef\u8bfb\u6d41:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"es.readable(function (count, callback) {\n  if(streamHasEnded)\n    return this.emit('end')\n  \n  //...\n  \n  this.emit('data', data) //use this way to emit multiple chunks per call.\n      \n  callback() // you MUST always call the callback eventually.\n             // the function will not be called again until you do this.\n})\n"})}),"\n",(0,a.jsx)(n.p,{children:"\u8f6c\u6362\u6d41:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"var es = require('event-stream')\nes.map(function (data, callback) {\n  //transform data\n  // ...\n  callback(null, data)\n})\n \n"})}),"\n",(0,a.jsx)(n.p,{children:"\u53ef\u5199\u6d41:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"var es = require('event-stream')\nes.map(function (data, callback) {\n  // ...\n  callback(null, null)\n})\n \n"})}),"\n",(0,a.jsx)(n.p,{children:"\u4f8b\u5b50:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"const es = require(\"event-stream\");\n\n//\u521b\u5efa\u4e00\u4e2a\u53ef\u8bfb\u6d41\nlet e = 0\nlet r = es.readable(function(count, callback) {\n    if (e > (10)) return this.emit('end')\n    this.emit('data', String(e));\n    e++;\n    return callback()\n});\n//\u8f6c\u6362\u6d41\nlet map = es.map(function (data, callback) {\n  data = `--${data}--`\n  callback(null, data)\n})\n\n//\u53ef\u5199\u6d41\uff0c\u8fd9\u91cc\u662f\u5c06\u6570\u636e\u6253\u5370\u51fa\u6765\nlet w = es.map(function (data, callback) {\n  log(data)\n  callback(null, null)\n})\n\nw.on('close',()=>{\n    log('\u64cd\u4f5c\u5b8c\u6210')\n});\n\nr.pipe(map).pipe(w);//\u5c063\u4e2a\u6d41\u8fde\u8d77\u6765\n"})}),"\n",(0,a.jsx)(n.p,{children:"\u4f8b\u5b502\uff08\u914d\u5408io\u6d41\u4f7f\u7528\uff09:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:'const es = require("event-stream");\nconst stream = require("stream")\n\nlet r = stream.createFileReadStream(\n    \'/sdcard/\u6587\u672c\u6587\u4ef6.txt\'\n)\n\n//\u53ef\u5199\u6d41\uff0c\u8fd9\u91cc\u662f\u5c06\u6570\u636e\u6253\u5370\u51fa\u6765\nlet w = es.map(function (data, callback) {\n  log(data)\n  callback(null, null)\n})\n\n//\u8fde\u901a\u6d41\uff0c\u5176\u4e2des.split()\u662f\u4e00\u4e2a\u6d41\uff0c\u8d1f\u8d23\u5c06\u6570\u636e\u6309\u884c\u8f93\u51fa\nr.pipe(es.split()).pipe(w)\n'})})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>c,x:()=>l});var a=t(6540);const r={},s=a.createContext(r);function c(e){const n=a.useContext(s);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),a.createElement(s.Provider,{value:n},e.children)}}}]);